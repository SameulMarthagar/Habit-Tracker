<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Habit Tracker Pro</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
:root{
  --blue:#2563eb;
  --bg:#f8fafc;
  --card:#ffffff;
  --gray:#cbd5e1;
}

body{
  margin:0;
  font-family:system-ui,-apple-system,BlinkMacSystemFont;
  background:var(--bg);
  color:#0f172a;
}

header{
  background:var(--card);
  padding:16px;
  font-size:20px;
  font-weight:600;
  box-shadow:0 2px 8px rgba(0,0,0,.05);
}

.container{padding:14px}

.card{
  background:var(--card);
  border-radius:16px;
  padding:16px;
  margin-bottom:16px;
  box-shadow:0 4px 12px rgba(0,0,0,.05);
}

h2{font-size:16px;margin-bottom:12px}

/* CALENDAR */
.calendar{
  display:grid;
  grid-template-columns:repeat(7,1fr);
  gap:6px;
}
.day{
  padding:10px 0;
  border-radius:999px;
  background:#e5e7eb;
  text-align:center;
  cursor:pointer;
}
.day.done{
  background:var(--blue);
  color:white;
}

/* YEAR GRID */
.year{
  display:grid;
  grid-template-columns:repeat(31,8px);
  gap:4px;
}
.block{
  width:8px;height:8px;
  border-radius:2px;
  background:#e5e7eb;
}
.block.done{background:var(--blue)}

.badge{
  display:inline-block;
  padding:6px 12px;
  border-radius:999px;
  background:var(--blue);
  color:white;
  font-size:12px;
  margin-top:8px;
}

input,button{
  padding:8px;
  border-radius:8px;
  border:1px solid var(--gray);
}
button{
  background:var(--blue);
  color:white;
  border:none;
  margin-left:6px;
}
</style>
</head>

<body>

<header>ðŸ”¥ Habit Tracker Pro</header>

<div class="container">

<!-- STREAK + BADGE -->
<div class="card">
  <h2>Streak</h2>
  <p>Current Streak: <b id="streak">0</b> days</p>
  <div id="badge"></div>
</div>

<!-- MONTH VIEW -->
<div class="card">
  <h2>June</h2>
  <div class="calendar" id="calendar"></div>
</div>

<!-- YEAR VIEW -->
<div class="card">
  <h2>Year Overview</h2>
  <div class="year" id="year"></div>
</div>

<!-- REMINDERS -->
<div class="card">
  <h2>Reminders</h2>
  <input type="date" id="remDate">
  <input placeholder="Reminder text" id="remText">
  <button onclick="addReminder()">Add</button>
  <ul id="reminders"></ul>
</div>

<!-- PIE CHART -->
<div class="card">
  <h2>Progress</h2>
  <canvas id="pie"></canvas>
</div>

</div>

<script>
let state=JSON.parse(localStorage.getItem("tracker"))||{
  days:Array(365).fill(false),
  reminders:[]
};

function save(){localStorage.setItem("tracker",JSON.stringify(state))}

function renderCalendar(){
  const c=document.getElementById("calendar");
  c.innerHTML="";
  for(let i=0;i<30;i++){
    const d=document.createElement("div");
    d.className="day"+(state.days[i]?" done":"");
    d.textContent=i+1;
    d.onclick=()=>{state.days[i]=!state.days[i];save();renderAll()};
    c.appendChild(d);
  }
}

function renderYear(){
  const y=document.getElementById("year");
  y.innerHTML="";
  state.days.forEach(d=>{
    const b=document.createElement("div");
    b.className="block"+(d?" done":"");
    y.appendChild(b);
  });
}

function calcStreak(){
  let s=0;
  for(let i=state.days.length-1;i>=0;i--){
    if(state.days[i]) s++;
    else break;
  }
  document.getElementById("streak").textContent=s;

  let badge="No badge yet";
  if(s>=100) badge="ðŸ† Legend (100+)";
  else if(s>=50) badge="ðŸ¥‡ Gold (50)";
  else if(s>=21) badge="ðŸ¥ˆ Silver (21)";
  else if(s>=7) badge="ðŸ¥‰ Bronze (7)";
  document.getElementById("badge").innerHTML=`<span class="badge">${badge}</span>`;
}

function renderChart(){
  const done=state.days.filter(d=>d).length;
  const miss=state.days.length-done;
  new Chart(document.getElementById("pie"),{
    type:"pie",
    data:{
      labels:["Done","Missed"],
      datasets:[{data:[done,miss],backgroundColor:["#2563eb","#cbd5e1"]}]
    }
  });
}

function addReminder(){
  const d=document.getElementById("remDate").value;
  const t=document.getElementById("remText").value;
  if(!d||!t)return;
  state.reminders.push({date:d,text:t});
  save();renderReminders();
}

function renderReminders(){
  const r=document.getElementById("reminders");
  r.innerHTML="";
  state.reminders.forEach(rem=>{
    r.innerHTML+=`<li>${rem.date} â€“ ${rem.text}</li>`;
  });
}

function notifyCheck(){
  if(Notification.permission!=="granted") return;
  const today=new Date().toISOString().slice(0,10);
  state.reminders.forEach(r=>{
    if(r.date===today){
      new Notification("Habit Reminder",{body:r.text});
    }
  });
}

if("Notification"in window){
  Notification.requestPermission();
}

function renderAll(){
  renderCalendar();
  renderYear();
  calcStreak();
  renderReminders();
  renderChart();
}

renderAll();
notifyCheck();
</script>

</body>
</html>
